{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Nike's Catering Services</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  <link rel="stylesheet" href="{% static 'css/navbar.css' %}">
  <link rel="stylesheet" href="{% static 'css/chatbot.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  
  <link rel="icon" type="image/x-icon" href="{% static 'images/logo-round.png' %}">


</head>

<body>

  <!-- NAV BAR -->
  {% include "navbar.html" %}

  <!-- CONTENT -->

  <!-- MAIN -->
  <header id="main">
    <h1>Nike's Catering Services</h1>
    <p>Nikes Catering Services brings your events to life with exceptional food, elegant styling, and professional
      coordination. Whether it's an intimate gathering or a grand celebration, we specialize in crafting memorable
      experiences tailored to your vision. With a commitment to quality and creativity, we handle every detail—so you
      can enjoy the moment. </p>
    <a href="#about-us" class="learnmore">LEARN MORE</a>
  </header>

  <!-- CHATBOT BUTTON -->
  {% if user.is_authenticated %}
  <a href="{% url 'chatbot' %}" id="chat-ai-btn" class="chat-ai-btn">
    <i class="fa-solid fa-comments"></i>
    <span>Ask Patrice</span>
  </a>
  {% endif %}


  <!-- OUR SERVICES -->
  <section id="services">
    <h1 class="services-title">OUR SERVICES</h1>
    <p>We offer full-service catering, event styling, and coordination tailored to your unique needs. From themed
      celebrations to formal occasions, our team ensures every detail is thoughtfully planned and flawlessly executed.
    </p>
    <div class="services-grid">
      <div class="service-box kiddieparty" data-event="Kiddie Party"
        style="background-image: url('{% static 'images/upgraded balloon set-up/R6A.jpg' %}');">
        KIDDIE PARTY
      </div>
      <div class="service-box birthday" data-event="Birthday"
        style="background-image: url('{% static 'images/birthday/greengold.jpg' %}');">
        BIRTHDAY
      </div>
      <div class="service-box wedding" data-event="Wedding"
        style="background-image: url('{% static 'images/signature set-up/R4A.jpg' %}');">
        WEDDING
      </div>
      <div class="service-box christening" data-event="Christening"
        style="background-image: url('{% static 'images/christening/bears.jpg' %}');">
        CHRISTENING
      </div>
      <div class="service-box corporate" data-event="Custom Event"
        style="background-image: url('{% static 'images/corporate/yellowblack.jpg' %}');">
        OTHERS
      </div>
    </div>
  </section>

  <!-- MENU -->
  <section id="menu">
    <div class="menu-content">
      <div class="menu-left">
        <h2>Nike's Featured Menus</h2>
        <p>Our menu features a diverse selection of delicious, handcrafted dishes made with fresh ingredients to suit
          any event or celebration.</p>
        <div class="menu-nav">
          <button class="prev">❮</button>
          <div class="dots">
            <span class="dot active"></span>
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </div>
          <button class="next">❯</button>
        </div>
      </div>

      <div class="menu-right">
        <div class="carousel-track">
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/bestsellers.jpg' %}');"></div>
            <span>BEST SELLERS</span>
          </div>
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/dessertbuffet.png' %}');"></div>
            <span>DESSERT BUFFET</span>
          </div>
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/beef.jpg' %}');"></div>
            <span>BEEF</span>
          </div>
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/chicken.jpg' %}');"></div>
            <span>CHICKEN</span>
          </div>
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/seafood.jpg' %}');"></div>
            <span>SEAFOODS</span>
          </div>
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/vegetable.jpg' %}');"></div>
            <span>VEGETABLES</span>
          </div>
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/pasta.jpg' %}');"></div>
            <span>PASTA</span>
          </div>
          <div class="menus">
            <div class="menu-bg" style="background-image: url('{% static 'images/menus/drinks.jpg' %}');"></div>
            <span>DRINKS</span>
          </div>

        </div>
      </div>
    </div>
    <a href="#calendar" class="book-tasting">
      <img src="{% static 'images/taste.png' %}" alt="Book Tasting">
      <h3>BOOK A FOOD TASTING</h3>
    </a>
  </section>


  <!-- PACKAGES -->
  <section id="packages">
    <div class="packages-header">
      <hr class="line left">
      <h1>EVENT PACKAGES</h1>
      <hr class="line right">
    </div>
    <p class="packages-subtitle">Our event packages are designed to fit every occasion, combining catering, styling, and
      coordination into convenient, customizable bundles.</p>

    <div class="packages-grid">
      <!-- Package 1 -->
      <div class="package" id="kiddie-package">
        <div class="package-title">KIDDIE PARTY PACKAGES</div>
        <div class="package-body">
          <div class="package-row">
            <div class="package-slider">
              <button class="pkg-prev">❮</button>
              <img class="pkg-image" src="{% static 'images/packages/christening1.jpg' %}" alt="Kiddie Party">
              <button class="pkg-next">❯</button>
            </div>
            <!-- <div class="package-selection">
              <h3>Want this as your package?</h3>

              <div class="form-group">
                <label for="event-type">Event Type:</label>
                <input type="text" id="event-type" value="Kiddie Party" readonly />
              </div>

              <div class="form-group">
                <label for="guest-count">Good for:</label>
                <select id="guest-count">
                  <option value="50">50 pax</option>
                  <option value="70">70 pax</option>
                  <option value="80">80 pax</option>
                  <option value="100">100 pax</option>
                  <option value="120">120 pax</option>
                  <option value="130">130 pax</option>
                  <option value="150">150 pax</option>
                  <option value="160">160 pax</option>
                  <option value="170">170 pax</option>
                  <option value="180">180 pax</option>
                  <option value="200">200 pax</option>
                </select>
              </div>

              <div class="package-buttons">
                <button type="button">PACKAGE A</button>
                <button type="button">PACKAGE B</button>
                <button type="button">PACKAGE C</button>
              </div>
            </div> -->
          </div>
        </div>
      </div>

      <!-- Package 2 -->
      <div class="package" id="birthday-package">
        <div class="package-title">BIRTHDAY PACKAGES</div>
        <div class="package-body">
          <div class="package-row">
            <div class="package-slider">
              <button class="pkg-prev">❮</button>
              <img class="pkg-image" src="{% static 'images/packages/packageb1.jpg' %}" alt="Birthday">
              <button class="pkg-next">❯</button>
            </div>
            <!-- <div class="package-selection">
              <h3>Want this as your package?</h3>

              <div class="form-group">
                <label for="event-type">Event Type:</label>
                <input type="text" id="event-type" value="Birthday" readonly />
              </div>

              <div class="form-group">
                <label for="guest-count">Good for:</label>
                <select id="guest-count">
                  <option value="50">50 pax</option>
                  <option value="70">70 pax</option>
                  <option value="80">80 pax</option>
                  <option value="100">100 pax</option>
                  <option value="120">120 pax</option>
                  <option value="130">130 pax</option>
                  <option value="150">150 pax</option>
                  <option value="160">160 pax</option>
                  <option value="170">170 pax</option>
                  <option value="180">180 pax</option>
                  <option value="200">200 pax</option>
                </select>
              </div>

              <div class="package-buttons">
                <button type="button">PACKAGE A</button>
                <button type="button">PACKAGE B</button>
                <button type="button">PACKAGE C</button>
              </div>
            </div> -->
          </div>
        </div>
      </div>

      <!-- Package 3 -->
      <div class="package" id="wedding-package">
        <div class="package-title">WEDDING PACKAGES</div>
        <div class="package-body">
          <div class="package-row">
            <div class="package-slider">
              <button class="pkg-prev">❮</button>
              <img class="pkg-image" src="{% static 'images/packages/packagec1.jpg' %}" alt="Wedding">
              <button class="pkg-next">❯</button>
            </div>
            <!-- <div class="package-selection">
              <h3>Want this as your package?</h3>

              <div class="form-group">
                <label for="event-type">Event Type:</label>
                <input type="text" id="event-type" value="Wedding" readonly />
              </div>

              <div class="form-group">
                <label for="guest-count">Good for:</label>
                <select id="guest-count">
                  <option value="50">50 pax</option>
                  <option value="70">70 pax</option>
                  <option value="80">80 pax</option>
                  <option value="100">100 pax</option>
                  <option value="120">120 pax</option>
                  <option value="130">130 pax</option>
                  <option value="150">150 pax</option>
                  <option value="160">160 pax</option>
                  <option value="170">170 pax</option>
                  <option value="180">180 pax</option>
                  <option value="200">200 pax</option>
                  <option value="250">250 pax</option>
                </select>
              </div>

              <div class="package-buttons">
                <button type="button">PACKAGE A</button>
                <button type="button">PACKAGE B</button>
                <button type="button">PACKAGE C</button>
              </div>
            </div> -->
          </div>
        </div>
      </div>

      <!-- Package 4 -->
      <div class="package" id="christening-package">
        <div class="package-title">CHRISTENING PACKAGES</div>
        <div class="package-body">
          <div class="package-row">
            <div class="package-slider">
              <button class="pkg-prev">❮</button>
              <img class="pkg-image" src="{% static 'images/packages/packaged1.jpg' %}" alt="Christening">
              <button class="pkg-next">❯</button>
            </div>
            <!-- <div class="package-selection">
              <h3>Want this as your package?</h3>

              <div class="form-group">
                <label for="event-type">Event Type:</label>
                <input type="text" id="event-type" value="Christening" readonly />
              </div>

              <div class="form-group">
                <label for="guest-count">Good for:</label>
                <select id="guest-count">
                  <option value="50">50 pax</option>
                  <option value="70">70 pax</option>
                  <option value="80">80 pax</option>
                  <option value="100">100 pax</option>
                  <option value="120">120 pax</option>
                  <option value="130">130 pax</option>
                  <option value="150">150 pax</option>
                  <option value="200">200 pax</option>
                </select>
              </div>

              <div class="package-buttons">
                <button type="button">PACKAGE A</button>
                <button type="button">PACKAGE B</button>
                <button type="button">PACKAGE C</button>
              </div>
            </div> -->
          </div>
        </div>
      </div>

      <!-- Package 5 -->
      <div class="package" id="custom-package">
        <div class="package-title">CUSTOM EVENT PACKAGES</div>
        <div class="package-body">
          <div class="package-row">
            <div class="package-slider">
              <button class="pkg-prev">❮</button>
              <img class="pkg-image" src="{% static 'images/packages/packaged1.jpg' %}" alt="Custom Event">
              <button class="pkg-next">❯</button>
            </div>
            <!-- <div class="package-selection">
              <h3>Want this as your package?</h3>

              <div class="form-group">
                <label for="event-type">Event Type:</label>
                <input type="text" id="event-type" value="Custom Event" readonly />
              </div>

              <div class="form-group">
                <label for="guest-count">Good for (rates per head):</label>
                <select id="guest-count">
                  <option value="below 100">below 100 pax</option>
                  <option value="100 and above">100 pax & above</option>
                </select>
              </div>

              <div class="package-buttons">
                <button type="button">PACKAGE A</button>
                <button type="button">PACKAGE B</button>
                <button type="button">PACKAGE C</button>
              </div>
            </div> -->
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- DESIGN -->
  <section id="design">
    <h1>EXPLORE OUR VARIOUS THEMES AND DESIGN</h1>
    <p>We bring your vision to life with creative themes and personalized event designs that reflect your style. From
      elegant to playful, every detail is crafted to create a cohesive and memorable atmosphere.</p>
    <div class="themes-grid">
      <a class="theme" href="{% url 'moredesign' %}?category=themed_backdrop"
        style="background-image: url('{% static 'images/upgraded balloon set-up/R1A.jpg' %}');">THEMED BACKDROP</a>
      <a class="theme" href="{% url 'moredesign' %}?category=minimalist_setup"
        style="background-image: url('{% static 'images/minimalist set-up/R1A.jpg' %}');">MINIMALIST SETUP</a>
      <a class="theme" href="{% url 'moredesign' %}?category=signature_setup"
        style="background-image: url('{% static 'images/signature set-up/R1A.jpg' %}');">SIGNATURE SETUP</a>
    </div>
    <a href="{% url 'moredesign' %}" class="more-design">
      MORE DESIGN
    </a>
  </section>

  <!-- CALENDAR -->
  <!-- <section id="calendar">
    <div class="calendar-title">CALENDAR</div>
    <div class="calendar-content">
      <div class="calendar-left">
        <img src="{% static 'images/maycalendar.jpg' %}" alt="Calendar">
      </div>
      <div class="calendar-right">
        <h1>BOOK WITH US!</h1>
        <p>Ready to plan your next event? Book with us today and let our team turn your ideas into an unforgettable
          celebration.</p> <a href={% url 'bookhere' %} class="book-calendar">
          <img src="{% static 'images/calendar.png' %}" alt="Book Here">
          <h3>BOOK HERE</h3>
        </a>
        <div class="legend">
        <h4>Legends:</h4>
        <ul>
          <li><span class="circle red"></span> 0 Slots left</li>
          <li><span class="circle violet"></span> 1 Slot left</li>
          <li><span class="circle orange"></span> 2 Slots left</li>
          <li><span class="circle yellow"></span> 3 Slots left</li>
          <li><span class="circle green"></span> 4 Slots left</li>
          <li><img src="{% static 'images/taste-legend.png' %}" alt="Food Tasting Icon" class="taste-icon" />Food Tasting</li>
        </ul>
      </div>

      </div>
    </div>
  </section> -->

  <!-- REVIEWS -->
  <section id="reviews">
    <div class="reviews-content">
      <!-- LEFT SIDE -->
      <div class="reviews-left">
        <h2 class="ritalic">Hear from our</h2>
        <h2 class="rbold">clients</h2>
        <p>Real stories from satisfied clients who trusted us to make their events unforgettable.</p>

        {% if top_reviews %}
        <div class="reviews-nav">
          <button class="rprev">❮</button>
          <div class="rdots">
            {% for review in top_reviews %}
              <span class="rdot {% if forloop.first %}active{% endif %}"></span>
            {% endfor %}
          </div>
          <button class="rnext">❯</button>
        </div>
        {% else %}
        <div class="no-reviews-message">
          <p class="text-muted">No featured reviews yet. Check back soon!</p>
        </div>
        {% endif %}
      </div>

      <!-- RIGHT SIDE -->
      <div class="reviews-right">
        {% if top_reviews %}
        <div class="review-slider">
          <div class="review-track">
            {% for review in top_reviews %}
            <div class="review">
              <div class="review-header">
                <img src="{% static 'images/quotation.png' %}" alt="Quote Icon" class="quote-icon">
                <div class="star-rating" data-rating="{{ review.rating }}"></div>
              </div>
              <p class="review-text">
                {{ review.comment }}
              </p>
              <div class="review-user">
                <div class="review-details">
                  <h3>{{ review.user.first_name }} {{ review.user.last_name }}</h3>
                  <p>{{ review.created_at|date:"F j, Y" }}</p>
                </div>
              </div>
            </div>
            {% endfor %}
          </div>
        </div>
        {% else %}
        <div class="no-reviews-placeholder">
          <div class="placeholder-content">
            <i class="fas fa-star" style="font-size: 3rem; color: #ddd; margin-bottom: 1rem;"></i>
            <h4>No Featured Reviews Yet</h4>
            <p class="text-muted">Featured reviews will appear here once our admin team bookmarks them.</p>
          </div>
        </div>
        {% endif %}
      </div>
    </div>
  </section>


  <!-- ABOUT US -->
  <section id="about-us">
    <div class="about-header">
      <h1>ABOUT US</h1>
      <h2><em>Nike’s Catering Services</em></h2>
    </div>

    <div class="about-content">
      <div class="about-logo">
        <img src="{% static 'images/CLogo-text.jpg' %}" alt="Company Logo">
      </div>
      <div class="about-text">
        <p>
          Nike's Catering Services began in 2014 as a party needs supplier, and has since expanded to provide
          all-inclusive packages for various occasions.
        </p>
        <p>
          As a commitment to bringing a tasteful yet affordable experience, Nike's Catering Services has become one of
          the top choice for catering and event suppliers in Bulacan and nearby cities.
        </p>
      </div>
    </div>
  </section>

  <!-- FAQs -->
  <section id="faqs">
    <h1 class="faq-title">FREQUENTLY ASKED QUESTIONS</h1>

    <div class="faq-container">
      <div class="faq-item">
        <div class="faq-question">How do I book a package?</div>
        <div class="faq-answer">
          You can book through our website, message us on Facebook, or contact us directly using the numbers provided in the Contact Us section.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">Do you offer custom event packages?</div>
        <div class="faq-answer">
          Yes! We customize packages based on your preferences. Let us know your budget, theme, and number of guests, and we'll take care of the rest.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">What are your mode of payments?</div>
        <div class="faq-answer">
          We cater cash and GCash payments.
        </div>
      </div>

      <div class="faq-item">
        <div class="faq-question">Can I request a food tasting before booking?</div>
        <div class="faq-answer">
          Absolutely. We offer scheduled food tasting sessions on every weekend of the month. You can book one directly through the "Book a Food Tasting" section.
        </div>
      </div>
    </div>
  </section>


  <!-- CONTACT US -->
  <section id="contact-us">
    <div class="contact-left">
      <div class="company">
        <img src="{% static 'images/CLogo-iNotext.png' %}" alt="Company Logo" class="clogo">
        <div class="left-text">
          <h1>Nike's</h1>
          <h2>Catering Services</h2>
          <p>Celebrate with Nikes!</p>
        </div>
      </div>


    </div>

    <div class="contact-right">
      <h1>CONTACT US</h1>

      <h2><i class="fa-solid fa-envelope"></i>
        <a href="mailto:nikescateringofficial@gmail.com">nikescateringofficial@gmail.com</a>
      </h2>

      <h2><i class="fa-brands fa-facebook"></i>
        <a href="https://www.facebook.com/nikescateringservicesofficial">Nike's Catering Services</a>
      </h2>

      <h2><i class="fa-solid fa-mobile-screen-button"></i>
        <a href="tel:+639662003092">+63 966 200 3092</a>
        <a href="tel:+639283452913">+63 928 345 2913</a>
      </h2>


    </div>
  </section>

  <!-- FUNCTIONS -->

  <!-- AI CHATBOT PRESENCE -->
  <script>
    const chatBtn = document.getElementById('chat-ai-btn');
    if (window.location.pathname.includes('login') || window.location.pathname.includes('register')) {
      if (chatBtn) chatBtn.style.display = 'none';
    }
  </script>

  <!-- SLIDER ON MENU -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
      const track = document.querySelector('.carousel-track');
      const slides = Array.from(track.children);
      const next = document.querySelector('.next');
      const prev = document.querySelector('.prev');
      const dots = document.querySelectorAll('.dot'); // exactly 5 dots
      const menuRight = document.querySelector('.menu-right');

      function getCardWidth() {
        const rect = slides[0].getBoundingClientRect();
        const mr = parseFloat(getComputedStyle(slides[0]).marginRight || '0');
        return rect.width + mr;
      }
      let index = 0;

      function getVisibleCount() {
        const containerWidth = menuRight.getBoundingClientRect().width;
        return Math.max(1, Math.floor(containerWidth / getCardWidth()));
      }

      function getMaxIndex() {
        const cardW = getCardWidth();
        const maxTranslate = Math.max(0, track.scrollWidth - menuRight.clientWidth);
        return Math.max(0, Math.floor(maxTranslate / cardW));
      }

      function clampIndex() {
        // Keep index within 0..(dots.length-1) so we only have 5 positions
        if (index < 0) index = 0;
        if (index > dots.length - 1) index = dots.length - 1;
      }

      function updateButtons() {
        // Always enabled for continuous loop UX
        prev.disabled = false;
        next.disabled = false;
      }

      function updateCarousel() {
        clampIndex();
        const cardW = getCardWidth();
        const maxTranslate = Math.max(0, track.scrollWidth - menuRight.clientWidth);
        const desired = index * cardW;
        const tx = Math.min(desired, maxTranslate);
        track.style.transform = `translateX(-${tx}px)`;
        // Exactly 5 dots – highlight the current step only
        dots.forEach((dot, i) => dot.classList.toggle('active', i === index));
        updateButtons();
      }

      next.addEventListener('click', () => {
        index = (index + 1) % dots.length; // loop after 5 steps
        updateCarousel();
      });

      prev.addEventListener('click', () => {
        index = (index - 1 + dots.length) % dots.length; // loop within 5 steps
        updateCarousel();
      });

      dots.forEach((dot, i) => {
        dot.addEventListener('click', () => {
          index = i;
          updateCarousel();
        });
      });

      window.addEventListener('resize', updateCarousel);
      updateCarousel();
    });
  </script>

  <!-- FOR PACKAGES -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const packageImages = [
        [
          "{% static 'images/packages/kiddie party/50pax.jpg' %}",
          "{% static 'images/packages/kiddie party/70pax.jpg' %}",
          "{% static 'images/packages/kiddie party/80pax.jpg' %}",
          "{% static 'images/packages/kiddie party/100pax.jpg' %}",
          "{% static 'images/packages/kiddie party/120pax.jpg' %}",
          "{% static 'images/packages/kiddie party/130pax.jpg' %}",
          "{% static 'images/packages/kiddie party/150pax.jpg' %}",
          "{% static 'images/packages/kiddie party/160pax.jpg' %}",
          "{% static 'images/packages/kiddie party/170pax.jpg' %}",
          "{% static 'images/packages/kiddie party/180pax.jpg' %}",
          "{% static 'images/packages/kiddie party/200pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/birthday/50pax.jpg' %}",
          "{% static 'images/packages/birthday/70pax.jpg' %}",
          "{% static 'images/packages/birthday/80pax.jpg' %}",
          "{% static 'images/packages/birthday/100pax.jpg' %}",
          "{% static 'images/packages/birthday/120pax.jpg' %}",
          "{% static 'images/packages/birthday/130pax.jpg' %}",
          "{% static 'images/packages/birthday/150pax.jpg' %}",
          "{% static 'images/packages/birthday/160pax.jpg' %}",
          "{% static 'images/packages/birthday/170pax.jpg' %}",
          "{% static 'images/packages/birthday/180pax.jpg' %}",
          "{% static 'images/packages/birthday/200pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/wedding/50pax.jpg' %}",
          "{% static 'images/packages/wedding/60pax.jpg' %}",
          "{% static 'images/packages/wedding/70pax.jpg' %}",
          "{% static 'images/packages/wedding/80pax.jpg' %}",
          "{% static 'images/packages/wedding/100pax.jpg' %}",
          "{% static 'images/packages/wedding/120pax.jpg' %}",
          "{% static 'images/packages/wedding/130pax.jpg' %}",
          "{% static 'images/packages/wedding/150pax.jpg' %}",
          "{% static 'images/packages/wedding/160pax.jpg' %}",
          "{% static 'images/packages/wedding/170pax.jpg' %}",
          "{% static 'images/packages/wedding/180pax.jpg' %}",
          "{% static 'images/packages/wedding/200pax.jpg' %}",
          "{% static 'images/packages/wedding/250pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/christening/50pax.jpg' %}",
          "{% static 'images/packages/christening/70pax.jpg' %}",
          "{% static 'images/packages/christening/80pax.jpg' %}",
          "{% static 'images/packages/christening/100pax.jpg' %}",
          "{% static 'images/packages/christening/120pax.jpg' %}",
          "{% static 'images/packages/christening/150pax.jpg' %}",
          "{% static 'images/packages/christening/200pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/others/below100.jpg' %}",
          "{% static 'images/packages/others/above100.jpg' %}",
        ]
      ];

      document.querySelectorAll('.package').forEach(function (pkg, pkgIdx) {
        const title = pkg.querySelector('.package-title');
        const body = pkg.querySelector('.package-body');
        const slider = pkg.querySelector('.package-slider');
        const img = pkg.querySelector('.pkg-image');
        const prev = pkg.querySelector('.pkg-prev');
        const next = pkg.querySelector('.pkg-next');
        let imgIdx = 0;

        // Accordion toggle
        title.addEventListener('click', function () {
          document.querySelectorAll('.package-body').forEach(b => {
            if (b !== body) b.classList.remove('open');
          });
          body.classList.toggle('open');
        });

        // Only run slider logic if slider exists
        if (slider && img && prev && next) {
          function updateImg() {
            img.src = packageImages[pkgIdx][imgIdx];
          }
          prev.addEventListener('click', function (e) {
            e.stopPropagation();
            imgIdx = (imgIdx - 1 + packageImages[pkgIdx].length) % packageImages[pkgIdx].length;
            updateImg();
          });
          next.addEventListener('click', function (e) {
            e.stopPropagation();
            imgIdx = (imgIdx + 1) % packageImages[pkgIdx].length;
            updateImg();
          });
          updateImg();
        }
      });
    });
  </script>

  <!-- For images in packages -->
  <div id="image-modal" class="image-modal">
    <button class="modal-prev">❮</button>
    <img class="modal-content" id="modal-img" src="" alt="Full Size">
    <button class="modal-next">❯</button>
    <span class="close-modal">&times;</span>
  </div>

  <script>
    // filepath: main/templates/main.html
    document.addEventListener('DOMContentLoaded', function () {
      // Use the same packageImages array as your slider
      const packageImages = [
        [
          "{% static 'images/packages/kiddie party/50pax.jpg' %}",
          "{% static 'images/packages/kiddie party/70pax.jpg' %}",
          "{% static 'images/packages/kiddie party/80pax.jpg' %}",
          "{% static 'images/packages/kiddie party/100pax.jpg' %}",
          "{% static 'images/packages/kiddie party/120pax.jpg' %}",
          "{% static 'images/packages/kiddie party/130pax.jpg' %}",
          "{% static 'images/packages/kiddie party/150pax.jpg' %}",
          "{% static 'images/packages/kiddie party/160pax.jpg' %}",
          "{% static 'images/packages/kiddie party/170pax.jpg' %}",
          "{% static 'images/packages/kiddie party/180pax.jpg' %}",
          "{% static 'images/packages/kiddie party/200pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/birthday/50pax.jpg' %}",
          "{% static 'images/packages/birthday/70pax.jpg' %}",
          "{% static 'images/packages/birthday/80pax.jpg' %}",
          "{% static 'images/packages/birthday/100pax.jpg' %}",
          "{% static 'images/packages/birthday/120pax.jpg' %}",
          "{% static 'images/packages/birthday/130pax.jpg' %}",
          "{% static 'images/packages/birthday/150pax.jpg' %}",
          "{% static 'images/packages/birthday/160pax.jpg' %}",
          "{% static 'images/packages/birthday/170pax.jpg' %}",
          "{% static 'images/packages/birthday/180pax.jpg' %}",
          "{% static 'images/packages/birthday/200pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/wedding/50pax.jpg' %}",
          "{% static 'images/packages/wedding/60pax.jpg' %}",
          "{% static 'images/packages/wedding/70pax.jpg' %}",
          "{% static 'images/packages/wedding/80pax.jpg' %}",
          "{% static 'images/packages/wedding/100pax.jpg' %}",
          "{% static 'images/packages/wedding/120pax.jpg' %}",
          "{% static 'images/packages/wedding/130pax.jpg' %}",
          "{% static 'images/packages/wedding/150pax.jpg' %}",
          "{% static 'images/packages/wedding/160pax.jpg' %}",
          "{% static 'images/packages/wedding/170pax.jpg' %}",
          "{% static 'images/packages/wedding/180pax.jpg' %}",
          "{% static 'images/packages/wedding/200pax.jpg' %}",
          "{% static 'images/packages/wedding/250pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/christening/50pax.jpg' %}",
          "{% static 'images/packages/christening/70pax.jpg' %}",
          "{% static 'images/packages/christening/80pax.jpg' %}",
          "{% static 'images/packages/christening/100pax.jpg' %}",
          "{% static 'images/packages/christening/120pax.jpg' %}",
          "{% static 'images/packages/christening/150pax.jpg' %}",
          "{% static 'images/packages/christening/200pax.jpg' %}",
        ],
        [
          "{% static 'images/packages/others/below100.jpg' %}",
          "{% static 'images/packages/others/above100.jpg' %}",
        ]
      ];

      const modal = document.getElementById('image-modal');
      const modalImg = document.getElementById('modal-img');
      const closeBtn = document.querySelector('.close-modal');
      const prevBtn = document.querySelector('.modal-prev');
      const nextBtn = document.querySelector('.modal-next');

      // Track which package and image is open
      let currentPackage = 0;
      let currentImgIdx = 0;

      // Find all .pkg-image and set up click
      document.querySelectorAll('.package').forEach(function (pkg, pkgIdx) {
        const imgs = pkg.querySelectorAll('.pkg-image');
        imgs.forEach(function (img) {
          img.addEventListener('click', function (e) {
            // Find the current image index in the packageImages array
            currentPackage = pkgIdx;
            // Find the current image index by matching src
            currentImgIdx = 0;
            const src = img.src;
            packageImages[pkgIdx].forEach((url, idx) => {
              // Django static URLs may be absolute or relative, so use includes
              if (src.includes(url.replace("{% static '", "").replace("' %}", ""))) {
                currentImgIdx = idx;
              }
            });
            showModalImage();
            modal.classList.add('open');
          });
        });
      });

      function showModalImage() {
        modalImg.src = packageImages[currentPackage][currentImgIdx];
      }

      prevBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        currentImgIdx = (currentImgIdx - 1 + packageImages[currentPackage].length) % packageImages[currentPackage].length;
        showModalImage();
      });

      nextBtn.addEventListener('click', function (e) {
        e.stopPropagation();
        currentImgIdx = (currentImgIdx + 1) % packageImages[currentPackage].length;
        showModalImage();
      });

      closeBtn.addEventListener('click', function () {
        modal.classList.remove('open');
        modalImg.src = '';
      });

      // Close modal on background click
      modal.addEventListener('click', function (e) {
        if (e.target === modal) {
          modal.classList.remove('open');
          modalImg.src = '';
        }
      });

      // Optional: Close modal on ESC key
      document.addEventListener('keydown', function (e) {
        if (e.key === "Escape") {
          modal.classList.remove('open');
          modalImg.src = '';
        }
      });
    });
  </script>



  <!-- STARS ON REVIEWS -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      document.querySelectorAll('.star-rating').forEach(container => {
        const rating = parseInt(container.getAttribute('data-rating'));
        container.innerHTML = '';
        for (let i = 1; i <= 5; i++) {
          const star = document.createElement('span');
          star.textContent = i <= rating ? '★' : '☆';
          container.appendChild(star);
        }
      });
    });
  </script>


  <!-- SLIDER FOR REVIEWS -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const track = document.querySelector('.review-track');
      const reviews = document.querySelectorAll('.review');
      const dots = document.querySelectorAll('.rdot');
      const prev = document.querySelector('.rprev');
      const next = document.querySelector('.rnext');
      
      // Only initialize slider if there are reviews
      if (track && reviews.length > 0 && dots.length > 0 && prev && next) {
        let index = 0;

        function updateSlider() {
          const reviewWidth = reviews[0].offsetWidth;
          track.style.transform = `translateX(-${index * reviewWidth}px)`;

          // Update active dot
          dots.forEach((dot, i) => dot.classList.toggle('active', i === index));
        }

        next.addEventListener('click', () => {
          index = (index + 1) % reviews.length;
          updateSlider();
        });

        prev.addEventListener('click', () => {
          index = (index - 1 + reviews.length) % reviews.length;
          updateSlider();
        });

        dots.forEach((dot, i) => {
          dot.addEventListener('click', () => {
            index = i;
            updateSlider();
          });
        });

        // Initialize stars
        document.querySelectorAll('.star-rating').forEach(container => {
          const rating = parseInt(container.getAttribute('data-rating'));
          container.innerHTML = '';
          for (let i = 1; i <= 5; i++) {
            const star = document.createElement('span');
            star.textContent = i <= rating ? '★' : '☆';
            container.appendChild(star);
          }
        });

        // Recalculate on window resize
        window.addEventListener('resize', updateSlider);

        updateSlider();
      }
    });
  </script>

  <!-- FOR DROPDOWN FAQS -->
   <script>
  document.addEventListener('DOMContentLoaded', function () {
    const faqItems = document.querySelectorAll('.faq-item');

    faqItems.forEach(item => {
      const question = item.querySelector('.faq-question');
      question.addEventListener('click', () => {
        item.classList.toggle('open');
      });
    });
  });
</script>


<!-- BOOK CONFIRMATION MODAL  OF SERICES-->
<div id="bookingModal" class="modal-overlay">
  <div class="modal-box">
    <h2 class="modal-title">Event Packages</h2>
    <p id="modal-message">Do you want to view the available packages for <span id="selected-event"></span>?</p>
    <div class="modal-actions">
      <button class="modal-btn confirm-btn">Yes, show packages</button>
      <button class="modal-btn cancel-btn">Cancel</button>
    </div>
  </div>
</div>

<!-- MODAL POPUP -->
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const serviceBoxes = document.querySelectorAll('.service-box');
    const modal = document.getElementById('bookingModal');
    const messageSpan = document.getElementById('selected-event');
    const confirmBtn = document.querySelector('.confirm-btn');
    const cancelBtn = document.querySelector('.cancel-btn');

    const packageIds = {
      'Kiddie Party': 'kiddie-package',
      'Birthday': 'birthday-package',
      'Wedding': 'wedding-package',
      'Christening': 'christening-package',
      'Custom Event': 'custom-package',
    };

    let selectedEvent = null;

    serviceBoxes.forEach(box => {
      box.addEventListener('click', () => {
        selectedEvent = box.getAttribute('data-event');
        messageSpan.textContent = selectedEvent;
        modal.style.display = 'flex';
      });
    });

    confirmBtn.addEventListener('click', () => {
      modal.style.display = 'none';
      const targetId = packageIds[selectedEvent];
      const target = document.getElementById(targetId);
      if (target) {
        document.querySelectorAll('.package-body').forEach(b => b.classList.remove('open'));
        const body = target.querySelector('.package-body');
        if (body) body.classList.add('open');
        const yOffset = -110; // Adjust this value as needed (e.g. navbar height)
        const y = target.getBoundingClientRect().top + window.pageYOffset + yOffset;
        window.scrollTo({ top: y, behavior: 'smooth' });

      }
    });

    cancelBtn.addEventListener('click', () => {
      modal.style.display = 'none';
    });

    // Optional: Close on click outside the modal box
    modal.addEventListener('click', (e) => {
      if (e.target === modal) {
        modal.style.display = 'none';
      }
    });
  });
</script>

<!-- User Notification Modal -->
{% if user.is_authenticated %}
<div class="modal fade user-notification-modal" id="userNotificationModal" tabindex="-1" aria-labelledby="userNotificationModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="userNotificationModalLabel">
          <i class="fas fa-bell"></i> Notifications
        </h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body p-0">
        <div id="userNotificationList" style="max-height: 400px; overflow-y: auto; overflow-x: hidden;">
          <div class="text-center p-4 text-muted">
            <i class="fas fa-bell-slash mb-2" style="font-size: 2rem;"></i>
            <p>No new notifications</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn" style="background: #AD974F; color: white;" onclick="markAllUserNotificationsAsRead()">
          Mark All as Read
        </button>
      </div>
    </div>
  </div>
</div>

<!-- User Notification Styles -->
<style>
.notification-btn {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 5px;
  text-decoration: none;
  color: inherit;
}

.notification-badge {
  position: absolute;
  top: -8px;
  right: -8px;
  background: #AD974F;
  color: #fff;
  border-radius: 50%;
  padding: 2px 6px;
  font-size: 10px;
  min-width: 18px;
  height: 18px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

.user-notification-modal .modal-content {
  background: #fff;
  border-radius: 10px;
  border: none;
}

.user-notification-modal .modal-header {
  background: #AD974F;
  color: #fff;
  border-radius: 10px 10px 0 0;
}

.user-notification-item {
  padding: 15px;
  border-bottom: 1px solid #eee;
  transition: background 0.2s;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.user-notification-item:hover {
  background: #f8f9fa;
}

.user-notification-item:last-child {
  border-bottom: none;
}

.user-notification-icon {
  width: 40px;
  height: 40px;
  background: #AD974F;
  color: #fff;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-right: 15px;
  flex-shrink: 0;
}

.user-notification-content {
  flex-grow: 1;
  min-width: 0;
  overflow: hidden;
}

.user-notification-title {
  font-weight: 600;
  color: #222;
  margin-bottom: 5px;
  word-wrap: break-word;
  overflow-wrap: break-word;
}

.user-notification-text {
  color: #666;
  font-size: 14px;
  margin-bottom: 5px;
  word-wrap: break-word;
  overflow-wrap: break-word;
  line-height: 1.4;
}

.user-notification-time {
  color: #999;
  font-size: 12px;
}

.user-notification-sender {
  color: #AD974F;
  font-size: 12px;
  font-weight: 500;
}

@keyframes slideIn {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

@keyframes slideOut {
  from { transform: translateX(0); opacity: 1; }
  to { transform: translateX(100%); opacity: 0; }
}

.user-notification-item:hover {
  background-color: #f8f9fa !important;
  transform: translateX(2px);
}

.toast-notification {
  position: fixed;
  top: 80px;
  right: 20px;
  background: #AD974F;
  color: white;
  padding: 15px 20px;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  z-index: 9999;
  max-width: 350px;
  animation: slideIn 0.3s ease-out;
}

.no-reviews-placeholder {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 300px;
  text-align: center;
}

.placeholder-content {
  max-width: 300px;
}

.no-reviews-message {
  margin-top: 20px;
}
</style>

<!-- User Notification JavaScript -->
<script>
let userNotificationCount = 0;
let userNotifications = [];

// Initialize user notification system
document.addEventListener('DOMContentLoaded', function() {
  loadUserNotifications();
  setupRealtimeUserNotifications();
});

function loadUserNotifications() {
  fetch('/notifications/')
    .then(response => response.json())
    .then(data => {
      userNotifications = data.notifications;
      updateUserNotificationUI();
    })
    .catch(err => console.error('Error loading user notifications:', err));
}

function updateUserNotificationUI() {
  const badge = document.getElementById('userNotificationBadge');
  const list = document.getElementById('userNotificationList');
  
  const unreadCount = userNotifications.filter(n => !n.is_read).length;
  
  if (unreadCount > 0) {
    badge.textContent = unreadCount;
    badge.style.display = 'flex';
  } else {
    badge.style.display = 'none';
  }
  
  if (userNotifications.length === 0) {
    list.innerHTML = `
      <div class="text-center p-4 text-muted">
        <i class="fas fa-bell-slash mb-2" style="font-size: 2rem;"></i>
        <p>No new notifications</p>
      </div>
    `;
  } else {
    list.innerHTML = userNotifications.map(notification => {
      // Determine icon based on notification type
      let icon = 'fas fa-envelope'; // default for admin message
      if (notification.notification_type === 'booking_update') {
        icon = 'fas fa-calendar-check';
      } else if (notification.notification_type === 'event_reminder') {
        icon = 'fas fa-clock';
      } else if (notification.notification_type === 'payment_update') {
        icon = 'fas fa-credit-card';
      }
      
      return `
        <div class="user-notification-item d-flex ${notification.is_read ? '' : 'bg-light'}" 
             data-id="${notification.id}" 
             data-booking-id="${notification.booking_id || ''}"
             data-notification-type="${notification.notification_type || 'admin_message'}"
             onclick="handleUserNotificationClick(this)"
             style="cursor: pointer; transition: all 0.2s ease;">
          <div class="user-notification-icon">
            <i class="${icon}"></i>
          </div>
          <div class="user-notification-content">
            <div class="user-notification-title">${notification.title}</div>
            <div class="user-notification-text">${notification.message}</div>
            <div class="user-notification-sender">From: ${notification.sender_name}</div>
            <div class="user-notification-time">${notification.created_at}</div>
          </div>
          ${!notification.is_read ? '<div class="text-primary"><i class="fas fa-circle" style="font-size: 8px;"></i></div>' : ''}
        </div>
      `;
    }).join('');
  }
}

function addUserNotification(data) {
  userNotifications.unshift({
    id: data.id,
    title: data.title,
    message: data.message,
    created_at: data.created_at,
    booking_id: data.booking_id,
    sender_name: data.sender_name,
    notification_type: data.type === 'booking_update' ? 'booking_update' : (data.type === 'event_reminder' ? 'event_reminder' : (data.type === 'payment_update' ? 'payment_update' : 'admin_message')),
    is_read: false
  });
  updateUserNotificationUI();
  
  // Show toast notification
  showUserToast(data.title, data.message);
}

function showUserToast(title, message) {
  // Create toast element
  const toast = document.createElement('div');
  toast.className = 'toast-notification';
  toast.innerHTML = `
    <div style="font-weight: 600; margin-bottom: 5px;">${title}</div>
    <div style="font-size: 14px; opacity: 0.9;">${message}</div>
  `;
  
  document.body.appendChild(toast);
  
  // Remove after 5 seconds
  setTimeout(() => {
    toast.style.animation = 'slideOut 0.3s ease-in';
    setTimeout(() => document.body.removeChild(toast), 300);
  }, 5000);
}

function markAllUserNotificationsAsRead() {
  fetch('/notifications/mark-all-read/', {
    method: 'POST',
    headers: {
      'X-CSRFToken': getCsrfToken(),
      'Content-Type': 'application/json',
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      userNotifications.forEach(n => n.is_read = true);
      updateUserNotificationUI();
    }
  })
  .catch(err => console.error('Error marking user notifications as read:', err));
}

function setupRealtimeUserNotifications() {
  // Use Server-Sent Events for real-time notifications
  const eventSource = new EventSource('/notifications/stream/');
  
  eventSource.onmessage = function(event) {
    try {
      const data = JSON.parse(event.data);
      if (data.type === 'admin_message' || data.type === 'booking_update' || data.type === 'event_reminder' || data.type === 'payment_update') {
        addUserNotification(data);
      }
    } catch (err) {
      console.error('Error parsing user notification data:', err);
    }
  };
  
  eventSource.onerror = function(event) {
    console.warn('User notification stream error:', event);
  };
}

// Handle notification click to navigate to booking or relevant page
function handleUserNotificationClick(element) {
  const bookingId = element.getAttribute('data-booking-id');
  const notificationId = element.getAttribute('data-id');
  const notificationType = element.getAttribute('data-notification-type');
  
  // Mark notification as read immediately
  markUserNotificationAsReadOnServer(notificationId);
  markUserNotificationAsRead(notificationId);
  
  // Close the modal first
  const modal = bootstrap.Modal.getInstance(document.getElementById('userNotificationModal'));
  if (modal) {
    modal.hide();
  }
  
  // Handle different notification types
  if (bookingId && bookingId !== 'null' && bookingId !== '') {
    if (notificationType === 'admin_message') {
      // Navigate to my bookings page for messages
      window.location.href = '/my_bookings';
    } else {
      // Navigate to event status page for booking updates and payment updates
      window.location.href = `/event-status/${bookingId}/`;
    }
  } else {
    // For general notifications, just close the modal
    console.log('General notification clicked');
  }
}

function markUserNotificationAsRead(notificationId) {
  // Update the notification visually
  const notificationElement = document.querySelector(`[data-id="${notificationId}"]`);
  if (notificationElement) {
    notificationElement.classList.remove('bg-light');
    const unreadIndicator = notificationElement.querySelector('.text-primary');
    if (unreadIndicator) {
      unreadIndicator.remove();
    }
  }
  
  // Update the notifications array
  const notification = userNotifications.find(n => n.id == notificationId);
  if (notification) {
    notification.is_read = true;
  }
  
  // Update badge count
  updateUserNotificationUI();
}

function markUserNotificationAsReadOnServer(notificationId) {
  fetch(`/notifications/${notificationId}/mark-read/`, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': getCsrfToken()
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.success) {
      console.log('User notification marked as read on server');
    }
  })
  .catch(err => console.error('Error marking user notification as read:', err));
}

function getCsrfToken() {
  return document.querySelector('[name=csrfmiddlewaretoken]')?.value || '';
}
</script>
{% endif %}

<!-- Bootstrap JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>